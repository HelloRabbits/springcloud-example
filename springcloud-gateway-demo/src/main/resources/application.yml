spring:
  application:
    name: gateway
  profiles:
    active: test
  cloud:
      gateway:
        discovery:
                locator:
                  #urlExpression: "'lb://'+serviceId+'/api/'"
                  enabled: true
                  lower-case-service-id: true
                  # 网关接口网址 http://gateway/api/{module}/test 转换成 http://{module}/test
                  predicates:
                  - name: Path
                    args:
                      pattern: "'/api/'+serviceId+'/**'"
                  filters:
                  - name: RewritePath
                    args:
                      regexp: "'/api/' + serviceId + '/(?<remaining>.*)'"
                      replacement: "'/$\\{remaining}'"
        routes:
        - id: goods
          uri: lb://goods
          #order: 8381
          predicates:
          - Path=/goods/**
          filters:
          - StripPrefix=1

logging:
  level:
    org.springframework.cloud.gateway: debug
server:
  port: 8081

eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/


#开启熔断配置
feign:
  client:
    config:
      default:
        connectTimeout: 1000
        readTimeout: 1000
        loggerLevel: basic
  hystrix.enabled: true
  #httpclient.enabled: false
  okhttp.enabled: true

#ribbon:
#  httpclient:
#    enabled: false
#  okhttp:
#    enabled: true
#  ReadTimeout: 600
#  SocketTimeout: 600
#  #请求连接的超时时间
#  ConnectTimeout: 600
#  maxAutoRetries: 0
#
#hystrix:
#  command:
#    default:
#      execution.isolation.thread.timeoutInMilliseconds: 600
#      circuitBreaker.sleepWindowInMilliseconds: 600
#      circuitBreaker.forceClosed: true
